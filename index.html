<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AnaLingo JSONP</title>
</head>
<body>

<h1>Dodela jezika</h1>
<input type="text" id="username" placeholder="Unesi nick">
<button onclick="assignLanguage()">Dodeli jezik</button>
<p id="result"></p>

<script>
function assignLanguage() {
  const username = document.getElementById("username").value.trim();
  if(!username){ 
    document.getElementById("result").innerText="Unesi nick!";
    return;
  }

  // Kreira script tag za JSONP
  const script = document.createElement("script");
  const callbackName = "handleResult";
  script.src = `https://script.google.com/macros/s/AKfycbzPaPNdou8ul4rRwEA-lqUmB8rNbsU_XFjH6AUdGS9sypNAUN0sLCOhUsQ7xdkwMrTMMQ/exec?username=${encodeURIComponent(username)}&callback=${callbackName}`;
  document.body.appendChild(script);
  script.remove(); // uklanja script tag nakon izvršenja
}

// Funkcija koja prima odgovor sa GAS-a
function handleResult(data){
  const resultEl = document.getElementById("result");
  if(data.assigned){
    resultEl.innerText = "Tvoj jezik: " + data.assigned;
  } else {
    resultEl.innerText = data.error || "Došlo je do greške";
  }
}
</script>

</body>
</html>
